vulnerability scanning theory
1. host discovery sudo nmap -sn -Pn <ip range> -Pn treats all host as up
2. port scanning sudo nmap -p <port range> <ip> || sudo nmap --tcp-topports=20 <ip> || sudo nmap -sS -sU -p <port range> <ip>
3. operating system, service and version dectection sudo nmap -O -sV <ip>
4. matching the results to a vulnerability database  CVE ect

CVSS common vulneravility scoring system
if no score is assigned can use CVSS calculator

manual and automated vulneravility scanning
manual: resource intensive and time consuming, but allows for doscpvery of complex and logical vulnerabilites that automated scripts can't do

automated: time constraints, when large amount of data need to script



types of vulnerability scans
external scan: going through dmz, accessible via the internet
internal scan: going in via vpn, internal network, pivoting
unauthenticated: no creditial needed (vulnrability in remotely accessible service on a target), no local security flaws
authenticated: need creditial, check for vulnerable packages missing patches or configuration vulnerabilities


Things to consider:

scanning duration: external sacnning means large amount of ip, need to plan

target visibility: external: if targets are accessible without VPN or permission in firewall

internal: firewalls, IPS, and routers and filter or alter traffic

rate limiting: if scan exceeds throughput, packet count or connection count, might miss hosts, remedy by adding delays, timeouts and limiting parallel connections

a lot of network traffic, reduce parrallel scan and scan speed




Nessus
sudo systemctl start nessusd.service to start the https://127.0.0.1:8834 site for nesses

scans & settings in essential 

enter info of smtp server to get scan result via email

nessus scan templates:
basic network scan: full scan. broad bariety of vulnerabilities recommended by nessus

advanced scan: no predefined settings, when we want to customize scan

general scanning template, advanced dynamic scan doesn't come with predefines



Performing a vulnerability scan:

new scan in the scans tab top right -> general v authenticaed
rememenber to change the port range if scaning specfic ports via the scan config

credential patch audit: missing os patch or outdated app, privilege escalation 

for linux and macos ssh is used for windows use smb or windows management instrumentation

care for target firewall & anti virus

windows: user account contril: sudo for windows



https://docs.tenable.com/nessus/Content/CredentialedChecksOnWindows.htm
make sure to consult this

if performing escalation make sure to include method for scanner to elevate privalege in the credentials tab


working with plugins nessus

fine tune and validate pervious finding or doscover all targets in env that's at risk of a specific vulnerability

new scan -> advanced dynamic scan -> same as the ssh process -> dynamic plugins (specify CVE number and preview) -> select family -> new filter -> 


Vulnerability scanning with Nmap

Nmap scripting engine vulnerability scriots
alternative to nessus
safe & vuln or intrusive & vuln
safe have no potential impact to stability 
intrusive might crash target service or system

NSE Documentaion: https://nmap.org/nsedoc/

in kali NSE are in /usr/share/nmap/scripts/

script.db is where all NSE are indexed 
so: cat script.db | grep "\"type"\" allows for searching of NSE


using filtering for all "vuln" type scripts on a scan:

sudo nmap -sV -p <port> --script "vuln" <ip>

* care for the port as it indirectly == to service
* might spam you, remember to -Og to grep it


NSE scripts working with

working with vuln manually: shove the CVE into a search engine + nse

if there is github, download it with cp and shove it into the nmap/scripts/ folder and update with --script-updatedb